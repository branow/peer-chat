<html>
<body>
  {{ define "home" }}
  <div class="page">
    <div class="quick-start">
      <div class="about">
        Hi, Here you can have a meeting with person from any place
        by internet.  Click button "create" below to create you own 
        room and invite your friends or meet a stranger. If your friends 
        already there just connection to them pressing button 'connect'.
        Any way, you always can connect to someones meeting/room. See them below. 
      </div>
      <div class="start-buttons">
        <button>Create</button>
        <button>Connect</button>
      </div>
    </div>
    <div class="rooms">
      <div class="rooms-search">

      </div>
      <div 
        class="room-list-container"
        hx-get="/x/rooms"
        hx-trigger="load"
      ></div>
    </div>
  </div>
  
  <div class="fixed-form" id="create-form">
    <form 
      class="form" 
      hx-post="/x/rooms/create"
      hx-target=".form-message"
    >
      <div class="form-title">
        Create New Room
      </div>
      <div class="form-message"></div>
      <input 
        class="form-input" 
        type="text"
        name="name"
        placeholder="Type room name"
      >
      <input
        class="form-input"
        type="radio"
        name="access"
        value="1"
        checked
      >
      <label>public</label>
      <input
        class="form-input"
        type="radio"
        name="access"
        value="0"
      >
      <label>private</label>
      <input type="submit" value="submit">
    </form>
  </div>
  
  <div class="fixed-form" id="connect-form">
    <form 
      class="form"
      hx-put="/x/rooms/connect"
      hx-target=".form-message"
    >
      <div class="form-title">
        Connect
      </div>
      <div class="form-message"></div>
      <input 
        class="form-input" 
        type="text"
        name="name"
        placeholder="Type room url"
      >
      <input type="submit" value="submit">
    </form>
  </div>

  <script>
    const createForm = document.getElementById('create-form');
    createForm.addEventListener('htmx:responseError', (event) => {
      if (event.detail.xhr.status === 400) {
        createForm.querySelector('.form-message').innerHTML = event.detail.xhr.responseText;
      }
    });
    const connectForm = document.getElementById('connect-form');
    connectForm.addEventListener('htmx:responseError', (event) => {
      if (event.detail.xhr.status === 400) {
        connectForm.querySelector('.form-message').innerHTML = event.detail.xhr.responseText;
      }
    });
  </script>
  {{ end }}
</body>
</html>